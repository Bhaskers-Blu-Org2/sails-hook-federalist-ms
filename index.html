<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-azure.html">azure</a><ul class='methods'><li data-type='method'><a href="module-azure.html#._checkDeploymentStatus">_checkDeploymentStatus</a></li><li data-type='method'><a href="module-azure.html#._checkResources">_checkResources</a></li><li data-type='method'><a href="module-azure.html#._checkRGExistence">_checkRGExistence</a></li><li data-type='method'><a href="module-azure.html#._createFTPDirectories">_createFTPDirectories</a></li><li data-type='method'><a href="module-azure.html#._createResourceGroup">_createResourceGroup</a></li><li data-type='method'><a href="module-azure.html#._deployResourceGroup">_deployResourceGroup</a></li><li data-type='method'><a href="module-azure.html#._deployTemplate">_deployTemplate</a></li><li data-type='method'><a href="module-azure.html#._ftpWalk">_ftpWalk</a></li><li data-type='method'><a href="module-azure.html#._getPublishingCredentials">_getPublishingCredentials</a></li><li data-type='method'><a href="module-azure.html#._setToken">_setToken</a></li><li data-type='method'><a href="module-azure.html#._uploadContent">_uploadContent</a></li><li data-type='method'><a href="module-azure.html#._uploadFTPFiles">_uploadFTPFiles</a></li><li data-type='method'><a href="module-azure.html#.cleanup">cleanup</a></li><li data-type='method'><a href="module-azure.html#.publish">publish</a></li></ul></li><li><a href="module-build.html">build</a><ul class='methods'><li data-type='method'><a href="module-build.html#._run">_run</a></li><li data-type='method'><a href="module-build.html#.hugo">hugo</a></li><li data-type='method'><a href="module-build.html#.jekyll">jekyll</a></li><li data-type='method'><a href="module-build.html#.publish">publish</a></li><li data-type='method'><a href="module-build.html#.static">static</a></li></ul></li><li><a href="module-federalistMS.html">federalistMS</a><ul class='methods'><li data-type='method'><a href="module-federalistMS.html#~configure">configure</a></li><li data-type='method'><a href="module-federalistMS.html#~hugo%257B@linkmodule:build.hugo%257D">hugo<a href="module-build.html#.hugo"><code>module:build.hugo</code></a></a></li><li data-type='method'><a href="module-federalistMS.html#~initialize">initialize</a></li><li data-type='method'><a href="module-federalistMS.html#~jekyll%257B@linkmodule:build.jekyll%257D">jekyll<a href="module-build.html#.jekyll"><code>module:build.jekyll</code></a></a></li><li data-type='method'><a href="module-federalistMS.html#~publish%257B@linkmodule:build.publish%257D">publish<a href="module-build.html#.publish"><code>module:build.publish</code></a></a></li><li data-type='method'><a href="module-federalistMS.html#~static%257B@linkmodule:build.static%257D">static<a href="module-build.html#.static"><code>module:build.static</code></a></a></li></ul></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><h1>sails-hook-federalist-ms</h1><p><a href="https://www.npmjs.com/package/sails-hook-federalist-ms"><img src="https://img.shields.io/npm/v/sails-hook-federalist-ms.svg" alt="npmbadge"></a></p>
<p>This installable hook for Sails.js incorporates both <a href="http://windows.com">Windows</a> and <a href="https://azure.microsoft.com">Microsoft Azure</a> extensibility in to <a href="https://github.com/18F/federalist">Federalist</a>, a static website management platform built and maintained by <a href="https://18f.gsa.gov">18F</a>. The hook is comprised of two components: build support for Windows (and <a href="http://azure.microsoft.com/en-us/services/app-service/web/">Azure Web Apps</a>) and static site publishing support for Azure.</p>
<p>New releases of this package will coincide with Federalist's current stage of development; based on 18F's <a href="https://18f.gsa.gov/dashboard/stages/">Project Stage Definitions</a>.</p>
<p>Detailed API documentation for this package can be found here: <a href="https://microsoft.github.io/sails-hook-federalist-ms/">https://microsoft.github.io/sails-hook-federalist-ms/</a>.</p>
<h2>Running Federalist on Windows</h2><p>In order to enable this hook, the <code>FEDERALIST_BUILD_ENGINE</code> environment variable must be set to 'federalist-ms'. By enabling this hook, the build engine will be configured to run tasks on Windows (or Web Apps), and the Azure site publishing feature will be activated.</p>
<p>If Federalist detects that the platform is running on Windows and the <code>FEDERALIST_BUILD_ENGINE</code> environment variable is not set, an error will be logged indicating that builds will fail until the variable is set correctly.</p>
<h3>Windows Build Engine</h3><p>Federalist works by executing a specific set of build tasks for each static site based on whether or not the site's content is built using a content generator (either <a href="http://jekyllrb.com/">Jekyll</a> or <a href="http://gohugo.io/">Hugo</a>). If the site isn't built with a generator, then the build engine simply stages the site's content for publishing as is.</p>
<p>When running Federalist on Windows (or on an <a href="http://azure.microsoft.com/en-us/services/app-service/web/">Azure Web App</a> as described below), this hook invokes the appropriate build tasks using <a href="https://en.wikipedia.org/wiki/Cmd.exe">CMD-based</a> syntax. All task output is redirected to stdout and subsequently attached to the Federalist logging engine.</p>
<p>Jekyll must be installed in order to build sites that are created with it. Instructions for installing Jekyll on Windows can be found <a href="http://jekyll-windows.juthilo.com/">here</a>. Similarly, Hugo is required to build sites that depend on it and installation instructions can be found <a href="http://gohugo.io/overview/installing/">here</a>.</p>
<h2>Azure Static Site Publishing</h2><p>Once a site has been built and staged, the hook will subsequently publish the content to an Azure Web App. In order to publish to Azure, a new Azure Active Directory native client application must be created. Instructions for doing so can be found <a href="https://msdn.microsoft.com/en-us/library/azure/dn132599.aspx#BKMK_Adding">here</a>. The 'Redirect URI' value is arbitrary and can be set to anything.</p>
<p>In addition, the following environment variables need to be set:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Environment Variable</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">FEDERALIST_BUILD_ENGINE</td>
<td style="text-align:left">Should be set to 'federalist-ms'</td>
</tr>
<tr>
<td style="text-align:left">FEDERALIST_AZURE_SUBSCRIPTION_ID</td>
<td style="text-align:left">Azure Subscription Id</td>
</tr>
<tr>
<td style="text-align:left">FEDERALIST_AZURE_TENANT_ID</td>
<td style="text-align:left">Azure Active Directory tenant Id</td>
</tr>
<tr>
<td style="text-align:left">FEDERALIST_AZURE_CLIENT_ID</td>
<td style="text-align:left">Azure Active Directory application client Id</td>
</tr>
<tr>
<td style="text-align:left">FEDERALIST_AZURE_USERNAME</td>
<td style="text-align:left">Azure Active Directory organizational account username (cannot be a Microsoft Account (e.g. Outlook, Live, etc)</td>
</tr>
<tr>
<td style="text-align:left">FEDERALIST_AZURE_PASSWORD</td>
<td style="text-align:left">Azure Active Directory organizational account password</td>
</tr>
<tr>
<td style="text-align:left">FEDERALIST_AZURE_REGION</td>
<td style="text-align:left">Azure Region for deployment (for new Web Apps)</td>
</tr>
</tbody>
</table>
<p>The Azure publishing process is based on the following execution sequence:</p>
<ol>
<li>Retrieve Azure Active Directory authorization token</li>
<li>Check for existence of Azure Web App</li>
<li>If Web App exists, skip to Step 6</li>
<li>Otherwise, provision new Azure Resource Group if one doesn't exist</li>
<li>Deploy template to Resource Group</li>
<li>Retrieve Web App site-level publishing credentials</li>
<li>Publish content to Web App via FTPS</li>
</ol>
<p>For the intial alpha release, FTPS is used to publish the site content. Future releases of this package will use Git for publishing. </p>
<h2>Running Federalist on Azure</h2><p>TODO</p>
<h2>Developing</h2><p>This hook is developed following the Sails.js <a href="http://sailsjs.org/documentation/concepts/extending-sails/hooks/hook-specification">hook specification</a>.</p>
<p>Execute the following command to install the package's dependencies:</p>
<pre class="prettyprint source lang-shell"><code>npm install</code></pre><p>Unit tests are developed using <a href="http://mochajs.org/">Mocha</a> which can be installed by running <code>npm install -g mocha</code>.</p>
<p><a href="http://gulpjs.com/">Gulp</a> is used to execute all unit tests and compile the documentation from the code. Execute the following command to initiate the build tasks:</p>
<pre class="prettyprint source lang-shell"><code>gulp</code></pre></article>
    </section>






</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> on Mon Aug 24 2015 17:35:50 GMT-0400 (Eastern Daylight Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>